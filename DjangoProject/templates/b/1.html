<link rel="stylesheet" type="text/css" href="css/styles.css">
<body>
    <img src="img/0.png" style="width:100%; height:100%">
    <div class="app" id="app">
        <div id="tt">
            <p>{{ contents }}</p>
        </div>
        <div id="Tc">
            <div id="tc">

            </div>
        </div>
        <!--<div id="input">
            <input type="text" id="text" v-model="newPerson.content" placeholder="">
            <input type="submit" id="createPerson" @click="createPerson" >
            <input type="submit" id="danmu" @click="danmu" >
            <input type="submit" id="picture" @click="picture" >
        </div>-->
    </div>
</body>

<script src="js/vue.js"></script>
<script src="js/vue-resource.common.js"></script>

<script>
    let timer = null;
    let timer2 = null;
    function $(id) { return document.getElementById(id) };
    let linenumber = 5;
    let aaaa = 0;
    let pic = [];
    let view = {{ view }};
    let con = {{ content }};
    let picurl = {{ picUrl }};
    let color = {{ color }};
    let bolt = {{ bolt }};
    let incline = {{ incline }};
    let underline = {{ underline }};

    new Vue({
        el: '#app',
        data: {
            addressList: [],
            timer: null,
            newarr: [],
            contents: "",
            newPerson: {
                person: '消息',
                content: '',
                headPortrait: 'img/1.jpg'
            }
        },
        mounted(){
            if (view == 1)
            {
                this.contents = con;
                $("tt").style.display = "block";
                if (bolt == true)
                {
                    $("tt").style.fontWeight = "bold";
                }
                if (incline == true)
                {
                    $("tt").style.fontStyle = "italic";
                }
                if (underline == true)
                {
                    $("tt").style.textDecoration = "underline";
                }
            }

            if (view == 2)
            {
                let _this = this;

                //danmu
                let newarr = [];
                clearInterval(timer2);
                let newnode = document.createElement("img");
                newnode.innerHTML = text;
                let num = parseInt((Math.random() * 10) % linenumber);
                let num2 = parseInt(($("tc").offsetHeight) / linenumber);
                newnode.style.top = (num * num2) + "px";
                newnode.style.height = num2 + "px";
                newnode.style.left = "100%";
                newnode.src = picurl;
                newnode.style.position = "absolute";
                $("tc").appendChild(newnode);
                pic.push(newnode.offsetLeft);
                timer2 = setInterval(this.move2, 0.05);
            }

            if (view == 3)
            {
                let _this = this;

                    //danmu
                    let newarr = [];
                    clearInterval(timer);
                    let text = con;
                    let newnode = document.createElement("div");
                    newnode.innerHTML = text;
                    let num = parseInt( (Math.random() * 10) % linenumber );
                    let num2 = parseInt( ($("tc").offsetHeight) / linenumber );
                    newnode.style.top = (num * num2) + "px";
                    newnode.style.height = num2 + "px";
                    newnode.style.fontSize = num2 + "px";
                    newnode.style.textAlign = "center";
                    newnode.style.lineHeight = "100%";
                    newnode.style.display = "flex";
                    newnode.style.left = "100%";
                    if (bolt == true)
                    {
                        newnode.style.fontWeight = "bold";
                    }
                    if (incline == true)
                    {
                        newnode.style.fontStyle = "italic";
                    }
                    if (underline == true)
                    {
                        newnode.style.textDecoration = "underline";
                    }
                    <!--newnode.style.background = "#" + this.randomColor();-->
                    newnode.style.background = color;
                    $("tc").appendChild(newnode);
                    timer = setInterval(this.move, 0.1);
            }
        },

        methods: {
            move: function () {
                let arr = $("tc").getElementsByTagName("div");
                for (let i = 0; i < arr.length; i++) {
                    let num2 = ((($("tc").offsetWidth) + (2 * arr[i].offsetWidth)) / 2000);
                    if (num2 <= 1)
                        num2 = 1;
                    let num = arr[i].offsetLeft - num2;
                    arr[i].style.left = num + "px";
                    if (num < -arr[i].offsetWidth) {
                        $("tc").removeChild(arr[i]);
                    }
                }
            },

            move2: function () {
                let arr = $("tc").getElementsByTagName("img");
                for (let i = 0; i < arr.length; i++) {
                    pic[i] = pic[i] - 1;
                    arr[i].style.left = pic[i] + "px";
                    if (pic[i] < -arr[i].offsetWidth) {
                        $("tc").removeChild(arr[i]);
                        pic.shift();
                    }
                }
            },

            randomColor: function () {
                let color = Math.ceil(Math.random() * 16777215).toString(16);
                while (color.length < 6) {
                    color = "0" + color;
                }
                return color;
            }
        }
    });
</script>
